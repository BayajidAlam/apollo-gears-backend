<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 650">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #1f2937; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #374151; }
      .box-title { font-family: Arial, sans-serif; font-size: 11px; font-weight: bold; fill: white; }
      .box-text { font-family: Arial, sans-serif; font-size: 9px; fill: #333; }
      .step-num { font-family: Arial, sans-serif; font-size: 11px; font-weight: bold; fill: white; }
      .arrow { stroke: #374151; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .arrow-user { stroke: #0ea5e9; stroke-width: 2; fill: none; marker-end: url(#arrow-blue); }
      .arrow-driver { stroke: #f97316; stroke-width: 2; fill: none; marker-end: url(#arrow-orange); }
      .arrow-system { stroke: #10b981; stroke-width: 2; fill: none; marker-end: url(#arrow-green); }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9"/>
    </marker>
    <marker id="arrow-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f97316"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10b981"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="950" height="650" fill="#fafafa"/>

  <!-- Title -->
  <text x="475" y="30" text-anchor="middle" class="title">Car Rental Business Logic - Data Flow Diagram</text>

  <!-- ============ ACTORS ============ -->
  <!-- User Actor -->
  <g transform="translate(30, 60)">
    <circle cx="40" cy="20" r="18" fill="#0ea5e9"/>
    <text x="40" y="25" text-anchor="middle" class="box-title">üë§</text>
    <text x="40" y="55" text-anchor="middle" class="subtitle" fill="#0ea5e9">USER</text>
  </g>

  <!-- Driver Actor -->
  <g transform="translate(30, 350)">
    <circle cx="40" cy="20" r="18" fill="#f97316"/>
    <text x="40" y="25" text-anchor="middle" class="box-title">üöó</text>
    <text x="40" y="55" text-anchor="middle" class="subtitle" fill="#f97316">DRIVER</text>
  </g>

  <!-- Admin Actor -->
  <g transform="translate(850, 60)">
    <circle cx="40" cy="20" r="18" fill="#8b5cf6"/>
    <text x="40" y="25" text-anchor="middle" class="box-title">‚öôÔ∏è</text>
    <text x="40" y="55" text-anchor="middle" class="subtitle" fill="#8b5cf6">ADMIN</text>
  </g>

  <!-- ============ STEP 1: BROWSE CARS ============ -->
  <g transform="translate(130, 55)">
    <circle cx="12" cy="12" r="12" fill="#374151"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">1</text>
  </g>
  <g transform="translate(150, 45)">
    <rect width="130" height="55" rx="8" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
    <text x="65" y="20" text-anchor="middle" class="box-text" font-weight="bold">Browse Cars</text>
    <text x="65" y="35" text-anchor="middle" class="box-text">GET /cars</text>
    <text x="65" y="47" text-anchor="middle" class="box-text">Search, Filter, Paginate</text>
  </g>

  <!-- ============ STEP 2: SELECT CAR ============ -->
  <g transform="translate(310, 55)">
    <circle cx="12" cy="12" r="12" fill="#374151"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">2</text>
  </g>
  <g transform="translate(330, 45)">
    <rect width="120" height="55" rx="8" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
    <text x="60" y="20" text-anchor="middle" class="box-text" font-weight="bold">Select Car</text>
    <text x="60" y="35" text-anchor="middle" class="box-text">GET /cars/:id</text>
    <text x="60" y="47" text-anchor="middle" class="box-text">View Details</text>
  </g>

  <!-- ============ STEP 3: CREATE RENT ============ -->
  <g transform="translate(480, 55)">
    <circle cx="12" cy="12" r="12" fill="#0ea5e9"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">3</text>
  </g>
  <g transform="translate(500, 45)">
    <rect width="140" height="70" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
    <text x="70" y="18" text-anchor="middle" class="box-text" font-weight="bold">Create Rent Request</text>
    <text x="70" y="32" text-anchor="middle" class="box-text">POST /rents</text>
    <text x="70" y="45" text-anchor="middle" class="box-text">{carId, userId,</text>
    <text x="70" y="57" text-anchor="middle" class="box-text">startingPoint, destination}</text>
  </g>

  <!-- Arrows Step 1-3 -->
  <line x1="90" y1="80" x2="145" y2="80" class="arrow-user"/>
  <line x1="280" y1="73" x2="325" y2="73" class="arrow-user"/>
  <line x1="450" y1="73" x2="495" y2="73" class="arrow-user"/>

  <!-- ============ RENT STATUS BOX ============ -->
  <g transform="translate(500, 140)">
    <rect width="140" height="40" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
    <text x="70" y="17" text-anchor="middle" class="box-text" font-weight="bold">Rent Status:</text>
    <text x="70" y="32" text-anchor="middle" class="box-text" fill="#f59e0b">PENDING</text>
  </g>
  <line x1="570" y1="115" x2="570" y2="135" class="arrow"/>

  <!-- ============ DATABASE (CENTER) ============ -->
  <g transform="translate(420, 270)">
    <ellipse cx="60" cy="15" rx="55" ry="15" fill="#ec4899"/>
    <rect x="5" y="15" width="110" height="70" fill="#ec4899"/>
    <ellipse cx="60" cy="85" rx="55" ry="15" fill="#be185d"/>
    <text x="60" y="40" text-anchor="middle" class="box-title">PostgreSQL</text>
    <text x="60" y="55" text-anchor="middle" class="box-text" fill="white">Users, Cars</text>
    <text x="60" y="68" text-anchor="middle" class="box-text" fill="white">Rents, Bids</text>
  </g>

  <!-- ============ STEP 4: DRIVER SEES PENDING RENTS ============ -->
  <g transform="translate(130, 340)">
    <circle cx="12" cy="12" r="12" fill="#f97316"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">4</text>
  </g>
  <g transform="translate(150, 330)">
    <rect width="140" height="55" rx="8" fill="#ffedd5" stroke="#f97316" stroke-width="2"/>
    <text x="70" y="18" text-anchor="middle" class="box-text" font-weight="bold">View Pending Rents</text>
    <text x="70" y="33" text-anchor="middle" class="box-text">GET /rents</text>
    <text x="70" y="45" text-anchor="middle" class="box-text">?rentStatus=pending</text>
  </g>

  <!-- ============ STEP 5: DRIVER PLACES BID ============ -->
  <g transform="translate(320, 340)">
    <circle cx="12" cy="12" r="12" fill="#f97316"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">5</text>
  </g>
  <g transform="translate(340, 325)">
    <rect width="130" height="70" rx="8" fill="#fed7aa" stroke="#ea580c" stroke-width="2"/>
    <text x="65" y="18" text-anchor="middle" class="box-text" font-weight="bold">Place Bid</text>
    <text x="65" y="32" text-anchor="middle" class="box-text">POST /bids</text>
    <text x="65" y="45" text-anchor="middle" class="box-text">{rentId, driverId,</text>
    <text x="65" y="57" text-anchor="middle" class="box-text">bidAmount, location}</text>
  </g>

  <!-- Arrows Step 4-5 -->
  <line x1="90" y1="370" x2="145" y2="360" class="arrow-driver"/>
  <line x1="290" y1="360" x2="335" y2="360" class="arrow-driver"/>

  <!-- ============ STEP 6: USER REVIEWS BIDS ============ -->
  <g transform="translate(130, 185)">
    <circle cx="12" cy="12" r="12" fill="#0ea5e9"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">6</text>
  </g>
  <g transform="translate(150, 175)">
    <rect width="130" height="55" rx="8" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
    <text x="65" y="18" text-anchor="middle" class="box-text" font-weight="bold">Review Bids</text>
    <text x="65" y="33" text-anchor="middle" class="box-text">GET /bids</text>
    <text x="65" y="45" text-anchor="middle" class="box-text">?rentId=xxx</text>
  </g>

  <!-- ============ STEP 7: USER ACCEPTS BID ============ -->
  <g transform="translate(130, 430)">
    <circle cx="12" cy="12" r="12" fill="#10b981"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">7</text>
  </g>
  <g transform="translate(150, 420)">
    <rect width="140" height="70" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
    <text x="70" y="18" text-anchor="middle" class="box-text" font-weight="bold">Accept Bid</text>
    <text x="70" y="32" text-anchor="middle" class="box-text">PATCH /bids/:id</text>
    <text x="70" y="45" text-anchor="middle" class="box-text">{bidStatus: "accepted"}</text>
    <text x="70" y="58" text-anchor="middle" class="box-text" fill="#10b981">‚Üí Auto-update Rent</text>
  </g>

  <!-- Arrow from Accept to Rent Status Update -->
  <path d="M 290 455 L 350 455 L 350 520 L 440 520" class="arrow-system"/>

  <!-- ============ RENT STATUS UPDATE ============ -->
  <g transform="translate(440, 500)">
    <rect width="160" height="55" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
    <text x="80" y="18" text-anchor="middle" class="box-text" font-weight="bold">System Auto-Update</text>
    <text x="80" y="33" text-anchor="middle" class="box-text">Rent.rentStatus =</text>
    <text x="80" y="48" text-anchor="middle" class="box-text" fill="#10b981" font-weight="bold">"ONGOING"</text>
  </g>

  <!-- Arrow User to Accept -->
  <path d="M 70 115 L 70 210 L 145 205" class="arrow-user"/>
  <path d="M 70 210 L 70 455 L 145 455" class="arrow-user"/>

  <!-- ============ STEP 8: COMPLETE RENT ============ -->
  <g transform="translate(630, 430)">
    <circle cx="12" cy="12" r="12" fill="#10b981"/>
    <text x="12" y="16" text-anchor="middle" class="step-num">8</text>
  </g>
  <g transform="translate(650, 420)">
    <rect width="130" height="60" rx="8" fill="#bbf7d0" stroke="#22c55e" stroke-width="2"/>
    <text x="65" y="18" text-anchor="middle" class="box-text" font-weight="bold">Complete Rent</text>
    <text x="65" y="33" text-anchor="middle" class="box-text">PATCH /rents/:id</text>
    <text x="65" y="48" text-anchor="middle" class="box-text">{rentStatus: "completed"}</text>
  </g>

  <line x1="600" y1="527" x2="650" y2="475" class="arrow-system"/>

  <!-- ============ ADMIN FLOW ============ -->
  <g transform="translate(700, 120)">
    <rect width="130" height="90" rx="8" fill="#ede9fe" stroke="#8b5cf6" stroke-width="2"/>
    <text x="65" y="18" text-anchor="middle" class="box-text" font-weight="bold">Admin Actions</text>
    <text x="65" y="35" text-anchor="middle" class="box-text">CRUD Cars</text>
    <text x="65" y="50" text-anchor="middle" class="box-text">Manage Users</text>
    <text x="65" y="65" text-anchor="middle" class="box-text">View All Rents</text>
    <text x="65" y="80" text-anchor="middle" class="box-text">View All Bids</text>
  </g>

  <line x1="870" y1="95" x2="835" y2="120" stroke="#8b5cf6" stroke-width="2" fill="none"/>

  <!-- Database connections -->
  <line x1="480" y1="180" x2="480" y2="265" class="arrow"/>
  <line x1="405" y1="395" x2="440" y2="320" class="arrow"/>
  <line x1="480" y1="360" x2="480" y2="320" class="arrow"/>
  <line x1="700" y1="210" x2="535" y2="280" class="arrow"/>

  <!-- ============ LEGEND ============ -->
  <g transform="translate(630, 570)">
    <rect width="290" height="65" rx="8" fill="white" stroke="#e5e7eb" stroke-width="1"/>
    <text x="145" y="18" text-anchor="middle" class="box-text" font-weight="bold">Legend</text>
    <circle cx="25" cy="35" r="8" fill="#0ea5e9"/>
    <text x="40" y="38" class="box-text">User Action</text>
    <circle cx="100" cy="35" r="8" fill="#f97316"/>
    <text x="115" y="38" class="box-text">Driver Action</text>
    <circle cx="190" cy="35" r="8" fill="#10b981"/>
    <text x="205" y="38" class="box-text">System</text>
    <circle cx="255" cy="35" r="8" fill="#8b5cf6"/>
    <text x="270" y="38" class="box-text">Admin</text>
    <line x1="25" y1="52" x2="55" y2="52" class="arrow"/>
    <text x="60" y="55" class="box-text">Data flow</text>
  </g>
</svg>
